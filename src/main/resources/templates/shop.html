<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Card Game Store</title>
    <link rel="stylesheet" href="user.css">
    <link rel="stylesheet" href="shop.css">
    <style>
.card {
  transition: transform 0.3s cubic-bezier(.25,.8,.25,1), box-shadow 0.2s;
  cursor: grab;
  /* Optional: for touch devices */
  touch-action: pan-x;
}
.card.dragging {
  box-shadow: 0 8px 32px rgba(30,58,92,0.18);
  z-index: 10;
  opacity: 0.85;
}
.modal-card-3d-wrapper {
  perspective: 900px;
  width: 100%;
  display: flex;
  justify-content: center;
}
.modal-card-3d {
  transition: transform 0.2s cubic-bezier(.25,.8,.25,1), box-shadow 0.2s;
  will-change: transform;
}
    </style>
</head>
<body>
    <!-- Add notification container -->
    <div class="notification-container" id="notificationContainer"></div>
    <div class="notification-history" id="notificationHistory">
        <div class="notification-history-header">
            <h3>Notifications</h3>
            <button id="clearNotifications">Clear All</button>
        </div>
        <ul id="notificationHistoryList"></ul>
    </div>

    <header>
        <div class="header-content">
            <div class="header-left">
                <a href="/index" aria-label="Go to homepage"><img src="logo.png" alt="TCG Store" style="vertical-align: middle; width: 32px;" /></a>
                <div class="search-container">
                    <input type="search" placeholder="Search cards..." class="search-input">
                    <button class="search-button">üîç</button>
                </div>
                <nav class="main-nav">
                    <a href="/index">Beranda</a>
                    <a href="/shop">Toko</a>
                    <a href="#popular">Populer</a>
                    <a href="#contact">Kontak</a>
                </nav>
            </div>
            <div class="header-right">
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">üåô</button>
                <button id="notificationLog" class="notification-log" aria-label="Notification history">
                    üîî<span class="notification-badge" id="notificationBadge">0</span>
                </button>
                <a href="/userInventory" class="inventory-link">üì¶ Inventory</a>
                <a href="/sign" class="login-link">üë§ Login</a>
            </div>
        </div>
    </header>

    <main class="container">
        <h2 style="text-align:center; margin:2rem 0 1rem 0; color:#3674B5;">Kartu TCG Dijual</h2>
        <div class="feature-grid" id="card-list">
            <th:block th:each="card : ${cards}">
                <div class="card">
                    <img th:src="@{'/textures/' + ${card.gambar}}" th:alt="${card.nama}" width="250" height="350"
                         onerror="this.onerror=null;this.src='https://via.placeholder.com/250x350?text=Image+Not+Available';">
                    <h4 th:text="${card.nama}">Card Name</h4>
                    <p th:text="'Rp' + ${#numbers.formatDecimal(card.harga, 0, 'COMMA', 2, 'POINT')}">Price</p>
                    <button class="cta-button"
                            th:attr="data-nama=${card.nama}, 
                                    data-deskripsi=${card.deskripsi}, 
                                    data-kondisi=${card.kondisi},
                                    data-rarity=${card.rarity},
                                    data-stok=${card.stok},
                                    data-harga=${card.harga},
                                    data-gambar='/textures/' + ${card.gambar}"
                            onclick="showModal(this)">View Details</button>
                    <button class="cta-button" style="margin-left:8px;background:#3674B5;color:#fff;" type="button" th:onclick="'showBuyModal(' + ${card.id} + ')'">Beli</button>
                </div>
            </th:block>
        </div>
    </main>

    <!-- Cart Modal -->
    <div id="cart-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; border-radius:10px; max-width:400px; width:90%; padding:2rem; margin:auto; position:relative;">
            <h3>Keranjang</h3>
            <ul id="cart-items" style="list-style:none; padding:0; margin-bottom:1rem;"></ul>
            <label for="payment-method">Pilih Pembayaran:</label>
            <select id="payment-method" style="width:100%; margin-bottom:1rem;">
                <option value="transfer">Transfer Bank</option>
                <option value="ewallet">E-Wallet</option>
                <option value="cod">COD</option>
            </select>
            <button class="cta-button" id="checkout-btn">Checkout</button>
            <button class="cta-button" style="background:#bbb; color:#333; margin-left:1rem;" id="close-cart">Tutup</button>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:1001; align-items:center; justify-content:center;">
        <div style="background:#fff; border-radius:10px; max-width:350px; width:90%; padding:2rem; margin:auto; text-align:center;">
            <h3>Pembelian Berhasil!</h3>
            <p>Kartu sudah masuk ke inventory Anda.</p>
            <button class="cta-button" id="close-success">OK</button>
        </div>
    </div>

    <!-- Modal Detail Kartu -->
    <div id="detail-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:2000; align-items:center; justify-content:center;">
      <div style="background:#fff; border-radius:16px; max-width:420px; width:98vw; padding:1.5rem 1.5rem 2rem 1.5rem; margin:auto; position:relative; box-shadow:0 8px 32px rgba(30,58,92,0.18);">
        <button onclick="closeDetailModal()" style="position:absolute;top:10px;right:10px;font-size:1.5rem;background:none;border:none;cursor:pointer;">&times;</button>
        <div class="modal-card-3d-wrapper">
          <img id="modal-gambar" src="" alt="Gambar Kartu" class="modal-card-3d" style="width:100%;max-width:340px;height:auto;display:block;margin:0 auto 1rem auto;border-radius:10px;box-shadow:0 2px 8px rgba(30,58,92,0.08);background:#f4f4f4;">
        </div>
        <h3 id="modal-nama" style="font-size:1.3rem;margin-bottom:0.5rem;text-align:center;"></h3>
        <p id="modal-deskripsi" style="font-size:1rem;margin-bottom:0.5rem;text-align:center;"></p>
        <p style="margin:0.2rem 0;"><b>Kondisi:</b> <span id="modal-kondisi"></span></p>
        <p style="margin:0.2rem 0;"><b>Rarity:</b> <span id="modal-rarity"></span></p>
        <p style="margin:0.2rem 0;"><b>Stok:</b> <span id="modal-stok"></span></p>
        <p style="margin:0.2rem 0 0.5rem 0;"><b>Harga:</b> <span id="modal-harga" style="color:#3674B5;font-weight:bold;"></span></p>
      </div>
    </div>

    <!-- Modal Pembelian -->
    <div id="buyModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;z-index:2100;">
      <div style="background:#fff;padding:2rem;border-radius:16px;max-width:350px;margin:auto;box-shadow:0 8px 32px rgba(30,58,92,0.18);position:relative;">
        <button onclick="closeBuyModal()" style="position:absolute;top:10px;right:10px;font-size:1.5rem;background:none;border:none;cursor:pointer;">&times;</button>
        <h2 style="text-align:center;margin-bottom:1rem;">Pembayaran</h2>
        <form id="buyForm" method="post">
          <input type="hidden" name="quantity" value="1" />
          <label for="paymentMethod">Pilih Metode Pembayaran:</label>
          <select name="paymentMethod" id="paymentMethod" required style="width:100%;margin-bottom:1rem;">
            <option value="transfer">Transfer Bank</option>
            <option value="cash">Cash</option>
          </select>
          <button type="submit" class="cta-button" style="width:100%;margin-bottom:0.5rem;">Bayar</button>
        </form>
      </div>
    </div>

    <section class="features" id="user-inventory">
        <div class="container">
            <h3>Inventory Anda</h3>
            <div class="feature-grid" id="inventory-list">
                <!-- Inventory user -->
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-sections">
            <div class="footer-section">
                <h4>Explore</h4>
                <ul>
                    <li>Our Story</li>
                    <li>Trading Guide</li>
                    <li>News & Updates</li>
                    <li>Community Guidelines</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Support</h4>
                <ul>
                    <li>Help Center</li>
                    <li>Contact Us</li>
                    <li>FAQ</li>
                    <li>Card Authentication</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Legal</h4>
                <ul>
                    <li>Terms & Conditions</li>
                    <li>Privacy Policy</li>
                    <li>Cookie Policy</li>
                    <li>Press Room</li>
                    <li>Become an Affiliate</li>
                </ul>
            </div>

            <!-- Social Icons -->
            <div class="footer-section social">
                <div class="social-icons">
                    <!-- Facebook -->
                    <a href="#" aria-label="Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="24" height="24">
                            <path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.8 90.69 226.4 209.3 245V327.7h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.3 482.4 504 379.8 504 256z"/>
                        </svg>
                    </a>
                    <!-- Twitter/X -->
                    <a href="#" aria-label="Twitter">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="24" height="24">
                            <path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/>
                        </svg>
                    </a>
                    <!-- Instagram -->
                    <a href="#" aria-label="Instagram">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="24" height="24">
                            <path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="links">
                <a href="#">Terms of Service</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Contact Support</a>
            </div>
            <div class="copyright">¬© 2025 Red Onion ‚Äì Peel the Layers, Trade the Legends.</div>
        </div>
    </footer>
    <!-- Add this right after the footer -->
    <div class="sticky-copyright" id="sticky-copyright">
        <div class="sticky-main">
            <span>&copy; 2025 Red Onion ‚Äì Peel the Layers, Trade the Legends.</span>
        </div>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            themeToggle.innerHTML = isDark ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        themeToggle.addEventListener('click', toggleTheme);

        // Check for saved user preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
            document.body.classList.add('dark-theme');
            themeToggle.innerHTML = '‚òÄÔ∏è';
        }

        // Notification System
        class NotificationSystem {
            constructor() {
                this.container = document.getElementById('notificationContainer');
                this.history = document.getElementById('notificationHistory');
                this.historyList = document.getElementById('notificationHistoryList');
                this.badge = document.getElementById('notificationBadge');
                this.clearButton = document.getElementById('clearNotifications');
                this.bellIcon = document.getElementById('notificationLog');
                this.notifications = [];
                this.unreadCount = 0;

                // Initialize event listeners
                this.bellIcon.addEventListener('click', () => this.toggleHistory());
                this.clearButton.addEventListener('click', () => this.clearHistory());

                // Close history panel when clicking outside
                document.addEventListener('click', (e) => {
                    if (!this.history.contains(e.target) && !this.bellIcon.contains(e.target)) {
                        this.history.classList.remove('show');
                    }
                });
            }

            // Other notification system methods will go here
        }

        // Initialize notification system
        const notificationSystem = new NotificationSystem();

        // Modal detail kartu
        function showModal(btn) {
          // Ambil data dari atribut data-*
          document.getElementById('modal-gambar').src = btn.getAttribute('data-gambar');
          document.getElementById('modal-nama').textContent = btn.getAttribute('data-nama');
          document.getElementById('modal-deskripsi').textContent = btn.getAttribute('data-deskripsi');
          document.getElementById('modal-kondisi').textContent = btn.getAttribute('data-kondisi');
          document.getElementById('modal-rarity').textContent = btn.getAttribute('data-rarity');
          document.getElementById('modal-stok').textContent = btn.getAttribute('data-stok');
          document.getElementById('modal-harga').textContent = 'Rp ' + btn.getAttribute('data-harga');
          document.getElementById('detail-modal').style.display = 'flex';
        }
        function closeDetailModal() {
          document.getElementById('detail-modal').style.display = 'none';
        }

        // Efek 3D pada kartu di modal detail
const modalCard3d = document.querySelector('.modal-card-3d');
const modalCard3dWrapper = document.querySelector('.modal-card-3d-wrapper');
if (modalCard3d && modalCard3dWrapper) {
  modalCard3dWrapper.addEventListener('mousemove', function(e) {
    const rect = modalCard3d.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;
    const rotateX = ((y - centerY) / centerY) * 10;
    const rotateY = ((x - centerX) / centerX) * 10;
    modalCard3d.style.transform = `rotateX(${-rotateX}deg) rotateY(${rotateY}deg)`;
    modalCard3d.style.boxShadow = `${-rotateY*2}px ${rotateX*2}px 24px 0 rgba(30,58,92,0.18)`;
  });
  modalCard3dWrapper.addEventListener('mouseleave', function() {
    modalCard3d.style.transform = '';
    modalCard3d.style.boxShadow = '';
  });
}

function showBuyModal(cardId) {
  document.getElementById('buyModal').style.display = 'flex';
  document.getElementById('buyForm').action = '/shop/buy/' + cardId;
}
function closeBuyModal() {
  document.getElementById('buyModal').style.display = 'none';
}
    </script>

    <script src="../src/main.js"></script>
</body>
</html>